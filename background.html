<script src="https://ajax.googleapis.com/ajax/libs/jquery/1.6.2/jquery.min.js"></script> 
<script src="https://github.com/allmarkedup/jQuery-URL-Parser/raw/v2.0/jquery.url.js"></script>
<script>

    var isLoginPage = function(url) {
        loginUrl = $.url('https://banking.triodos.es/isum/Main')
        var is = ['protocol', 'host', 'port', 'path'].every(function(part) {
            return url.attr(part) == loginUrl.attr(part)
        })
        return is && url.param('ISUM_SCR') == 'login'
    }

    var isPublicPage = function(url) {
        publicUrl = $.url('http://www.triodos.es')
        return ['protocol', 'host', 'port'].every(function(part) {
            return url.attr(part) == publicUrl.attr(part)
        })
    }

    var pageType = function(url) {
        url = $.url(url)
        if (isLoginPage(url)) return 'login'
        if (isPublicPage(url)) return 'public'
    }

    chrome.tabs.onUpdated.addListener(function(tabId, changeInfo, tab) {
        var type = pageType(tab.url)
        if (type) {
            chrome.pageAction.show(tabId)
            console.log(type)
            chrome.tabs.executeScript(tabId, { file: type + '-page.js' })
        } else {
            chrome.pageAction.hide(tabId)
        }
    })
</script>
